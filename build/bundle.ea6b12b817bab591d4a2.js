!function(e){function t(o){if(n[o])return n[o].exports;var i=n[o]={i:o,l:!1,exports:{}};return e[o].call(i.exports,i,i.exports,t),i.l=!0,i.exports}var n={};t.m=e,t.c=n,t.d=function(e,n,o){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:o})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="./build/",t(t.s=1)}([function(e,t,n){"use strict";function o(e,t){function n(e){e.preventDefault(),r(i,a,o)}var o=t.OrginalImage,i=t.canvas,a=t.originalFileName;e.addEventListener("click",n)}function i(e){console.log(e)}function r(e,t,n){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:i,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:i,l=t+"-minimage-"+d+".png";a(e,n,o,r),c(e,l,o,r),d++}function a(e,t,n,o){try{var i=e.getContext("2d"),r=i.globalCompositeOperation;return i.globalCompositeOperation="destination-over",i.drawImage(t,0,0,e.width,e.height),i.globalCompositeOperation=r,o&&setTimeout(o),e}catch(e){n&&n(e)}}function c(e,t,n,o){try{e.toBlob(function(e){try{if(window.navigator.msSaveOrOpenBlob)window.navigator.msSaveBlob(e,t),o&&setTimeout(o);else{var i=window.URL.createObjectURL(e),r=document.createElement("a");document.body.appendChild(r),r.setAttribute("href",i),r.setAttribute("download",t),r.click(),o&&setTimeout(o),setTimeout(function(){window.URL.revokeObjectURL(i),document.body.removeChild(r)},3e3)}}catch(e){n&&n(e)}})}catch(e){n&&n(e)}}Object.defineProperty(t,"__esModule",{value:!0}),t.makeDownloadLink=o,t.triggerDownload=r,t.mergeCanvasAndImage=a;var d=0},function(e,t,n){e.exports=n(2)},function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}function i(e){function t(e){"eraser"==e?y():w(e)}F=e,x();var n=L("drawzone"),o=L("drawzoneWrapper");L("inputForAFile").style.display="none",L("drawAndDownload").style.display="",console.log(e.width,e.height);var i=2*Math.max(window.innerWidth,window.innerHeight),r=Math.max(e.width/i,e.height/i,1);e.width=n.width=e.width/r,e.height=n.height=e.height/r,o.style.maxWidth=e.width,o.style.maxHeight=e.height,o.appendChild(e);var c=(n.getContext("2d"),!1),d=L("topbar").classList,l=L("background"),s=(0,a.default)(L("pensizePreview"),{canvasForCursor:n,onColorChange:t,elementToContrastWith:l}),m=s.setColorDotSize,h=s.refreshColorPreviewBorder,p=(s.clearColorPicker,(0,f.default)(n,{onMouseDown:function(){n.getClientRects()[0].height+160>window.innerHeight&&d.add("drawInProgress")},onMouseUp:function(){c||(c=!0,download.classList.add("usable")),d.remove("drawInProgress")},OrginalImage:F})),w=p.drawWithColor,y=p.drawWithEraser,b=p.setPencilSize;(0,u.default)(l,{onChange:h}),(0,g.default)(L("pensize"),{onChange:function(e){m(e),b(e)}}),(0,v.makeDownloadLink)(L("download"),{OrginalImage:F,originalFileName:E,canvas:n}),(0,C.detectCtrlS)({canvas:n,OrginalImage:F,originalFileName:E})}n(3);var r=n(4),a=o(r),c=n(8),d=o(c),l=n(9),u=o(l),s=n(10),f=o(s),v=n(0),m=n(11),g=o(m),h=n(12),p=o(h),w=n(13),y=n(14),C=n(15),b=n(16),k=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(b),L=document.getElementById.bind(document);k.install(),(0,w.checkRunWithinWebview)();var E=void 0,F=void 0;(0,d.default)({fileinput:L("fileinput"),onImageCreated:function(e,t){E=t,i(e)},startTask:y.startTask,endTask:y.endTask});var M=(0,p.default)(L("welcome"),{fitWindow:!0}),x=M.stopAnim,O=M.bgColor;L("fileInputWrapper").style.color=O},function(e,t){},function(e,t,n){"use strict";function o(e,t){if("eraser"==e)return"transparent";var n=(0,l.luminance)(t),o=(0,l.luminance)(e);return n>125&&o>200?"black":n<125&&o<25?"white":"transparent"}function i(e){return(0,l.luminance)(e)>127.5?"rgba(0,0,0,0.8)":"rgba(255,255,255,0.8)"}function r(e,t){(0,s.createModal)("color-modal",function(n){function o(e){a(),t(e)}var r=n.modal,a=n.closeModal;u.paletteColors.forEach(function(t){var n=document.createElement("button");n.classList.add("colorbutton"),t===e&&(n.classList.add("active"),n.innerHTML="Selected",n.style.color=i(t)),n.style.backgroundColor=t.toLowerCase(),n.addEventListener("click",function(){return o(t)}),r.appendChild(n)});var c=document.createElement("button");c.classList.add("eraser"),c.addEventListener("click",function(){return o("eraser")}),c.innerHTML='<img src="/images/eraser-color.svg"/><span class="imagelabel">'+("eraser"===e?"Eraser selected":"Eraser")+"</span>",r.appendChild(c)})}function a(e,t,n){var o=t<4?4:t,i=document.createElement("canvas");i.width=i.height=o;var r=i.getContext("2d");"eraser"==n?d(r,o):c(r,o,n);var a=i.toDataURL("image/png");e.style.cursor="url("+a+") "+o/2+" "+o/2+",auto"}function c(e,t,n){e.beginPath(),e.arc(t/2,t/2,t/2,0,2*Math.PI,!1),e.fillStyle=n,e.fill()}function d(e,t){e.fillStyle="#da502d",e.fillRect(0,0,2*t/3,t),e.fillStyle="#6584a5",e.fillRect(2*t/3-1,0,t,t),e.globalCompositeOperation="destination-in",c(e,t,"white")}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){function n(){m.style.background=o(g,u.style.backgroundColor)}function i(){r(g,c)}function c(e){console.log("onColorPicked",e),g&&e!==g&&(h=g),localStorage.setItem("previousColor",h),g=e,a(s,p,g),"eraser"==e?(v.style.background="",v.classList.add("eraser")):(v.classList.remove("eraser"),v.style.background=e,n()),localStorage.setItem("color",e),l(e)}function d(e){p=e,a(s,p,g),v.style.transform="scale("+e/w+")",m.style.transform="scale("+(e/w+1/w)+")"}var l=t.onColorChange,u=t.elementToContrastWith,s=t.canvasForCursor,v=e.children[0],m=e.children[1],g=void 0;e.addEventListener("click",i);var h=localStorage.getItem("previousColor")||"eraser",p=void 0,w=v.getBoundingClientRect().width;return window.addEventListener("keydown",function(e){"x"===String.fromCharCode(e.which).toLowerCase()&&(console.log("x switching to "+h),c(h))}),setTimeout(function(){return c(localStorage.getItem("color")||f)}),{clearColorPicker:function(){e.removeEventListener("click",i)},setColorDotSize:d,refreshColorPreviewBorder:n}};var l=n(5),u=n(6),s=n(7),f="#2b76ce"},function(e,t,n){"use strict";function o(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function i(e){var t=document.createElement("canvas");t.width=t.height=1;var n=t.getContext("2d");return n.clearRect(0,0,1,1),n.fillStyle=e,n.fillRect(0,0,1,1),[].concat(o(n.getImageData(0,0,1,1).data)).slice(0,3)}function r(e){return i(e).reduce(function(e,t){return e+t},0)/3}Object.defineProperty(t,"__esModule",{value:!0}),t.colorToRGB=i,t.luminance=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.paletteColors="#000000,#FFFFFF,#F44336,#E91E63,#9C27B0,#673AB7,#3F51B5,#2196F3,#03A9F4,#00BCD4,#009688,#4CAF50,#8BC34A,#CDDC39,#FFEB3B,#FFC107,#FF9800,#FF5722,#795548,#9E9E9E,#607D8B".split(",")},function(e,t,n){"use strict";function o(e,t){function n(e){27==e.which&&o()}function o(){r.classList.add("closing"),a.classList.add("closing"),setTimeout(function(){document.body.removeChild(r),document.body.removeChild(a)},300),document.removeEventListener("keyup",n)}var r=document.createElement("div");r.classList.add("modal"),r.classList.add(e),document.body.appendChild(r);var a=document.createElement("div");return a.classList.add("modal-backdrop"),document.body.appendChild(a),a.style.zIndex=i,r.style.zIndex=i+1,a.addEventListener("click",o),document.addEventListener("keyup",n),i+=2,t({modal:r,closeModal:o})}Object.defineProperty(t,"__esModule",{value:!0}),t.createModal=o;var i=4},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){function t(e){c();var t=new FileReader;t.onload=function(){n(t.result),l()},t.onerror=l,t.readAsDataURL(e)}function n(e){if(c(),s){var t=new Image;t.onload=function(){s=!1,i(t,u),l()},t.onerror=l,t.src=e}}function o(e){var o=Array.prototype.find.call(e,function(e){return"file"==e.kind&&e.type.match("image")});if(u="pasted-image",o)return void t(o.getAsFile());var i=Array.prototype.find.call(e,function(e){return"string"==e.kind});i&&i.getAsString(function(e){return n(e)})}var i=e.onImageCreated,r=e.fileinput,a=e.startTask,c=void 0===a?function(){return null}:a,d=e.endTask,l=void 0===d?function(){return null}:d,u="pasted-image",s=!0;!function(){function e(n){r.removeEventListener("change",e),u=r.value.split("\\").pop().split(".")[0]||"image",t(n.target.files[0])}r&&r.addEventListener("change",e)}(),window.addEventListener("paste",function(e){o(e.clipboardData.items)}),document.body.addEventListener("dragover",function(e){e.preventDefault(),e.stopPropagation()}),document.body.addEventListener("drop",function(e){e.preventDefault(),e.stopPropagation(),o(e.dataTransfer.items)})}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){function n(){a++,localStorage.setItem("background",a),o()}function o(){var t=["#DDD","#333"],n=a%t.length;e.style.backgroundColor=t[n],i(n);var o=document.body.classList;t.forEach(function(e,t){return o.remove("background_n_"+t)}),o.add("background_n_"+n),r<8?(console.log(0==n?"jour !":"nuit !"),r++):console.log("Monsieur Jacquouille, je vous en prie, à la longue, ça devient casse-pied !")}var i=t.onChange,r=0,a=localStorage.getItem("background")||0;o(),e.addEventListener("click",n)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){function n(){m=e.getBoundingClientRect(),v=m.width/e.width,g&&h&&(h.lineWidth=g/v)}function i(e){return{x:(e.clientX-m.left)/v,y:(e.clientY-m.top)/v}}function r(){y||(y=!0,h.beginPath(),c())}function a(){y&&s(),y=!1}function c(){y&&(window.requestAnimationFrame(c),d())}function d(){h.moveTo(w.x,w.y),h.lineTo(p.x,p.y),h.stroke(),w=p}function l(t,n){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e;e.addEventListener(t,function(e){e.preventDefault();var t=e.touches[0]||{},i=t.clientX,r=t.clientY,a=new MouseEvent(n,{clientX:i,clientY:r});o.dispatchEvent(a)},!1)}var u=t.onMouseDown,s=t.onMouseUp,f=t.OrginalImage,v=void 0,m=void 0,g=void 0;n(),window.addEventListener("resize",n);var h=e.getContext("2d");h.lineCap="round";var p={x:0,y:0},w=p;e.addEventListener("mousedown",function(t){if(3==t.which)return void(0,o.mergeCanvasAndImage)(e,f);p=w=i(t),r(),u()},!1),document.addEventListener("copy",function(t){t.preventDefault(),(0,o.mergeCanvasAndImage)(e,f),t.clipboardData.setData("text/html",'<img src="'+e.toDataURL()+'"/>')}),document.addEventListener("mouseup",a,!1),e.addEventListener("mousemove",function(e){p=i(e)},!1);var y=!1;return l("touchstart","mousedown"),l("touchend","mouseup",document),l("touchmove","mousemove"),{drawWithEraser:function(){h.globalCompositeOperation="destination-out"},drawWithColor:function(e){h.globalCompositeOperation="source-over",h.strokeStyle=e},setPencilSize:function(e){g=e,h.lineWidth=e/v}}};var o=n(0)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){function n(t){e.value=t,localStorage.setItem("pensize",t),i(t)}var i=t.onChange;e.addEventListener("input",function(e){return n(e.target.value)}),n(parseInt(localStorage.getItem("pensize"))||o)};var o=20},function(e,t,n){"use strict";function o(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=e.filter(function(e){return e!=t});return n[Math.floor(Math.random()*n.length)]}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){function n(){u&&(e.width=window.innerWidth,e.height=window.innerHeight),f=e.width,v=e.height,s=e.getContext("2d"),s.fillStyle=m,s.fillRect(0,0,f,v),s.lineCap="round",r()}function r(){g={x:f/2,y:v/2},h={x:10*Math.random()-5,y:10*Math.random()-5},p={x:10*Math.random()-5,y:10*Math.random()-5},s.strokeStyle=o(i,m),s.lineWidth=20+40*Math.random(),s.beginPath(),s.moveTo(g.x,g.y)}function a(){p={x:2*Math.random()-1,y:2*Math.random()-1},w=setTimeout(a,100+200*Math.random())}function c(){s.moveTo(g.x,g.y),h.x*=.95,h.y*=.95,h.x+=p.x,h.y+=p.y,g.x+=h.x,g.y+=h.y,s.lineTo(g.x,g.y),s.stroke(),(g.x<-50||g.x>f+50||g.y<-50||g.y>v+50)&&r()}function d(){y&&(window.requestAnimationFrame(d),c())}function l(){y=!1,clearTimeout(w),window.removeEventListener("resize",n)}var u=t.fitWindow,s=void 0,f=void 0,v=void 0,m="#F44336",g=void 0,h=void 0,p=void 0,w=void 0;n(),window.addEventListener("resize",n),a();var y=!0;return d(),{stopAnim:l,bgColor:m}};var i="#F44336,#E91E63,#9C27B0,#673AB7,#3F51B5,#2196F3,#03A9F4,#00BCD4,#009688,#4CAF50,#8BC34A,#CDDC39,#FFEB3B,#FFC107,#FF9800,#FF5722".split(",")},function(e,t,n){"use strict";function o(){if(navigator.userAgent.match(/Android/i)){var e=document.createElement("script");e.src="https://iswebview.herokuapp.com/?callback=JSONPcallback",document.body.appendChild(e)}}Object.defineProperty(t,"__esModule",{value:!0}),t.checkRunWithinWebview=o,window.JSONPcallback=function(e){e.isWebView&&(document.body.classList.add("runningWithinWebview"),document.body.innerHTML='\n      Please open minimage.tk with chrome,\n       it cannot work within another app.\n\n        There may be an option in the menu above the page,\n         something like "Open in Chrome".\n\n         ')}},function(e,t,n){"use strict";function o(){a++,r()}function i(){a--,setTimeout(r)}function r(){spinners.classList[a?"remove":"add"]("hidden")}Object.defineProperty(t,"__esModule",{value:!0}),t.startTask=o,t.endTask=i,t.updateLook=r;var a=0;document.addEventListener("DOMContentLoaded",r)},function(e,t,n){"use strict";function o(e){var t=e.canvas,n=e.OrginalImage,o=e.originalFileName;window.addEventListener("keydown",function(e){(e.ctrlKey||e.metaKey)&&"s"===String.fromCharCode(e.which).toLowerCase()&&(e.preventDefault(),(0,i.triggerDownload)(t,o,n))})}Object.defineProperty(t,"__esModule",{value:!0}),t.detectCtrlS=o;var i=n(0)},function(e,t){function n(){return"serviceWorker"in navigator&&(window.fetch||"imageRendering"in document.documentElement.style)&&("https:"===window.location.protocol||"localhost"===window.location.hostname||0===window.location.hostname.indexOf("127."))}function o(e){if(e||(e={}),n()){navigator.serviceWorker.register("build/sw.js")}else if(window.applicationCache){var t=function(){var e=document.createElement("iframe");e.src="build/appcache/manifest.html",e.style.display="none",a=e,document.body.appendChild(e)};return void("complete"===document.readyState?setTimeout(t):window.addEventListener("load",t))}}function i(e,t){}function r(){if(n()&&navigator.serviceWorker.getRegistration().then(function(e){if(e)return e.update()}),a)try{a.contentWindow.applicationCache.update()}catch(e){}}var a;t.install=o,t.applyUpdate=i,t.update=r}]);
//# sourceMappingURL=bundle.ea6b12b817bab591d4a2.js.map